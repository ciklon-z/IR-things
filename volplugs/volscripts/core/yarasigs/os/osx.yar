
rule OSX_Defma_2
{
strings:
	$a0 = { 303030313135353733313633363330303030343630303030303030323633352e2f4d6163446566656e6465722e617070 }

condition:
	$a0
}

	
rule OSX_Defma_1
{
strings:
	$a0 = { 6f70656e55524c3a0076616c7565466f724b65793a0073686f774e6f74696669636174696f6e3a3a3a0072656d6f7665416c6c4f626a656374730064696374696f6e617279576974684f626a65637473416e644b6579733a0072656c6561736500687474703a2f2f6761792e706f }

condition:
	$a0
}

	
rule Trojan_OSX_RSPlug_C
{
strings:
	$a0 = { 7461696c202d[2-4]2430[0-150]207c2075756465636f6465202d6f202f6465762f7374646f7574 }

condition:
	$a0
}

	
rule Trojan_OSX_Opener
{
strings:
	$a0 = { 73637269707420746f207475726e206f6e207365727669636573 }
	$a1 = { 6370202d52202f4c6962726172792f4170706c6550617373776f7264536572766572202f2e696e666f2f4c6962726172792f4170706c6550617373776f7264536572766572 }
	$a2 = { 6e697574696c202d63726561746570726f70202f202f75736572732f6861636b6572207265616c6e616d6520224861636b6572 }

condition:
	$a0 and $a1 and $a2
}

	
rule Trojan_OSX_Hellraiser_A
{
strings:
	$a0 = { 4c61756e63682061747461636b }
	$a1 = { 42727574616c2047696674 }
	$a2 = { 5468652077617920746f20746561636820796f7520686f7720746f207368757420796f7572206675636b696e67206d6f757468 }

condition:
	$a0 and $a1 and $a2
}

	
rule Trojan_OSX_MacBack
{
strings:
	$a0 = { 736572732f6170706c652f446f63756d656e74732f6d6163206261636b2f746f6f6c732f6b756e62616e672f544d6163 }

condition:
	$a0
}

	
rule OSX_Flashfake_2
{
strings:
	$a0 = { 2f4170706c69636174696f6e732f5361666172692e6170702f436f6e74656e74732f5265736f75726365732f2e57696e646f7773414354495641544f522e706e67 }

condition:
	$a0
}

	
rule Trojan_OSX_SMSsend_A
{
strings:
	$a0 = { 706179666f726d2e706870 }
	$a1 = { 534d5320666f722061637469766174696f6e }
	$a2 = { 6f6b616c7920646f6b616c79 }
	$a3 = { 7468616e6b20796f75[0-5]616275736521 }

condition:
	$a0 and $a1 and $a2 and $a3
}

	
rule OSX_Trojan_Pintsized
{
strings:
	$a0 = { 3c706c6973743e3c646963743e[0-128]3c737472696e673e2f75736572732f[0-32]2f2e637570732f63757073643c2f737472696e673e3c737472696e673e2d7a3c2f737472696e673e }

condition:
	$a0
}

	
rule OSX_Flashback_22
{
strings:
	$a0 = { 2f55736572732f64617669646d636b2f4c6962726172792f4170706c69636174696f6e20537570706f72742f2e416c6c47616d657366726f6d2e746d70 }

condition:
	$a0
}

	
rule VirTool_OSX_Rubilyn_B
{
strings:
	$a0 = { 2f7573722f7362696e2f73797363746c[10]64656275672e727562696c796e }
	$a1 = { 70726f63657373 }
	$a2 = { 68696465 }
	$a3 = { 6261636b646f6f72 }

condition:
	$a0 and $a1 and $a2 and $a3
}

	
rule Trojan_OSX_Miner_A
{
strings:
	$a0 = { 446961626c6f4d696e65722d4f53582e7368[40-50]6d696e657264202d2d75726c20687474703a2f2f24313a2432 }

condition:
	$a0
}

	
rule Trojan_OSX_AppleScriptTHT_A
{
strings:
	$a0 = { 4845592120596f75206d696768742077616e7420746f206368616e6765207468657365 }
	$a1 = { 54686573652061726520746865207472206b65797320666f72206675786f7220616e642064656675786f72 }
	$a2 = { 6d76202d66202f6574632f68747470642f68747470642e636f6e66202f6574632f68747470642f68747470642e636f6e662e4153746874 }

condition:
	$a0 and $a1 and $a2
}

	
rule OSX_Flashback_5
{
strings:
	$a0 = { 47455400557365722d4167656e740077620073797363746c }

condition:
	$a0
}

	
rule Trojan_OSX_RSPlug_J
{
strings:
	$a0 = { 67656e657261746f722e706c20485454502f312e305c725c6e557365722d4167656e743a20222e7472696d2860756e616d65202d7060292e223b2472756e747970653b373737373b222e7472696d2860686f73746e616d6560 }

condition:
	$a0
}

	
rule Trojan_OSX_Renepo_H
{
strings:
	$a0 = { 46696e6973686564206d6f766520746f2053797374656d204c69627261727920537461727475704974656d73 }
	$a1 = { 636c6f626265722075746d7020736f2074686174207768656e20776520636f6e6e65637420746865792063616e277420736565207573 }
	$a2 = { 726d202f7661722f72756e2f75746d70 }
	$a3 = { 636c6f62626572204c6974746c65536e69746368 }

condition:
	$a0 and $a1 and $a2 and $a3
}

	
rule OSX_Tored
{
strings:
	$a0 = { 54726164756374696e6720616e642064656372797074696e67206d657373616765202e2e2e2e203a596f757220696e666f726d6174696f6e20776173202e2e2e00000000156d61696c2e6d79534d54505365727665722e636f }
	$a1 = { 466f72204d6163204f5320582021203a28496620796f7520617265206e6f74206f6e204d616320706c656173652074 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_MacDefender_B
{
strings:
	$a0 = { 6f72636865737472616c5f74615f64615f7374696e6765725f30312e6d7033[0-200]64726962626c65626565702e776176 }
	$a1 = { 687474703a2f2f2540[1-10]7068703f6166666964 }

condition:
	$a0 and $a1
}

	
rule OSX_Flashback_8
{
strings:
	$a0 = { 557365722d4167656e7400484f4d4500494f536572766963653a }

condition:
	$a0
}

	
rule OSX_Flashback_9
{
strings:
	$a0 = { 557365722d4167656e74007762002f62696e2f736800 }

condition:
	$a0
}

	
rule OSX_SubPub
{
strings:
	$a0 = { 4163636570742d456e636f64696e673a206261736536342c677a6970 }
	$a1 = { 2f746d702f73637265656e2e6a706567 }

condition:
	$a0 and $a1
}

	
rule OSX_Flashback_21
{
strings:
	$a0 = { 6b696c6c616c6c20536166617269 }
	$a1 = { 687474703a2f2f61646f6265736f6674776172657570646174652e636f6d2f636f756e7465722f }

condition:
	$a0 and $a1
}

	
rule OSX_Trojan_Pintsized_1
{
strings:
	$a0 = { 3c706c6973743e3c646963743e }
	$a1 = { 3c737472696e673e2f7573722f62696e2f7065726c3c2f737472696e673e[0-128]75736520536f636b65743b }
	$a2 = { 6f70656e28535444494e[0-32]6f70656e285354444f5554[0-32]3b6578656328 }

condition:
	$a0 and $a1 and $a2
}

	
rule Trojan_OSX_Morcut_A
{
strings:
	$a0 = { 617474616368546f4d656d6f7279526567696f6e }
	$a1 = { 616d4953616e64626f786564 }
	$a2 = { 6d416d495072697655736572 }

condition:
	$a0 and $a1 and $a2
}

	
rule OSX_Trojan_HellRTS
{
strings:
	$a0 = { 446f776e6c6f6164546872656164203d204e696c203f213f0007302e302e302e3000093132372e302e302e3100014000074443484b47203c0003546f3a000546726f6d3a001f48656c6c52616973657220686173206265656e20696e }

condition:
	$a0
}

	
rule Trojan_OSX_DevilRobber_A
{
strings:
	$a0 = { 4c6962726172792f6d64736131333331[10-15]6d647361 }

condition:
	$a0
}

	
rule Trojan_OSX_MacDefender_C
{
strings:
	$a0 = { 6f72636865737472616c5f74615f64615f7374696e6765725f30312e6d7033[0-200]64726962626c65626565702e776176 }
	$a1 = { 687474703a2f2f2540[1-10]7068702540 }

condition:
	$a0 and $a1
}

	
rule OSX_Trojan_2
{
strings:
	$a0 = { 7461696c202d[2-4]202430207c207461696c202d72207c2075756465636f6465202d6f }

condition:
	$a0
}

	
rule Trojan_OSX_FlashBack_A
{
strings:
	$a0 = { 2f4c6962726172792f4c6974746c6520536e697463682f6c7364[0-200]61646f6265736f6674776172657570646174652e636f6d2f636f756e746572 }

condition:
	$a0
}

	
rule Trojan_Downloader_OSX_Fav_A
{
strings:
	$a0 = { 4d41432f4641562f5372632f496e7374616c6c65722f446f776e6c6f616457696e4374726c2e6d6d }
	$a1 = { 446f776e6c6f616450696374 }
	$a2 = { 6170702e7a6970 }
	$a3 = { 687474703a2f2f2540[5-100]2e7068703f61666669643d2540 }
	$a4 = { 6364202f4170706c69636174696f6e733b756e7a6970202540 }

condition:
	$a0 and $a1 and $a2 and $a3 and $a4
}

	
rule OSX_DevilRobber
{
strings:
	$a0 = { 2e2f706f6c69706f202d6320706f6c69706f2e6366672026 }

condition:
	$a0
}

	
rule Trojan_Downloader_OSX_Fav_B
{
strings:
	$a0 = { 4d41432f4641562f5372632f496e7374616c6c65722f446f776e6c6f616457696e4374726c2e6d6d }
	$a1 = { 446f776e6c6f616450696374 }
	$a2 = { 687474703a2f2f2540 }
	$a3 = { 2e7068703f61666669643d2540 }
	$a4 = { 6170702e7a6970 }
	$a5 = { 6364202f4170706c69636174696f6e733b756e7a6970202540 }

condition:
	$a0 and $a1 and $a2 and $a3 and $a4 and $a5
}

	
rule Trojan_OSX_MacDefender
{
strings:
	$a0 = { 6f72636865737472616c5f74615f64615f7374696e6765725f30312e6d7033[0-200]64726962626c65626565702e776176 }
	$a1 = { 687474703a2f2f36392e35302e3231342e35[1-10]7068703f6166666964 }

condition:
	$a0 and $a1
}

	
rule OSX_Flashback_20
{
strings:
	$a0 = { 557365722d4167656e74 }
	$a1 = { 2f4c6962726172792f4c6974746c6520536e69746368 }
	$a2 = { 687474703a2f2f }
	$a3 = { 6a636f756e746572 }

condition:
	$a0 and $a1 and $a2 and $a3
}

	
rule MacOSX_iMuler_1
{
strings:
	$a0 = { 2f55736572732f6170706c652f446f63756d656e74732f6d6163206261636b }

condition:
	$a0
}

	
rule OSX_Word_Malware_1
{
strings:
	$a0 = { 23212f62696e2f7368 }
	$a1 = { 2f746d702f6c61756e63682d6873652026 }
	$a2 = { 6f70656e202f746d702f66696c652e646f632026 }

condition:
	$a0 and $a1 and $a2
}

	
rule Trojan_OSX_Crisis_A
{
strings:
	$a0 = { 6973437269736973486f6f6b417070[0-10]69734372697369734e6574417070[0-100]636f6d6d756e6963617465576974684167656e7473[0-100]77696c6c53746f70437269736973 }

condition:
	$a0
}

	
rule OSX_Flashfake_1
{
strings:
	$a0 = { 6c6f6164010002726d0100032d726601 }

condition:
	$a0
}

	
rule OSX_Flashfake
{
strings:
	$a0 = { 6e6465720047455400557365722d4167 }
	$a1 = { 7570646174653f69663d252666753d25 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_Crisis_B
{
strings:
	$a0 = { 6261636b646f6f725f696e6974[0-200]686964655f6b657874 }
	$a1 = { 6d63686f6f6b5f7374617274 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_Dockster_B
{
strings:
	$a0 = { 737472696e673e6d61632e446f636b7365742e64656d616e3c2f737472696e67[50-60]737472696e673e2f55736572732f746573742f2e446f636b7365743c2f737472696e67 }

condition:
	$a0
}

	
rule Trojan_OSX_Dockster_A
{
strings:
	$a0 = { 2f62696e2f756e6c696e6b207e2f2e446f636b736574 }
	$a1 = { 6c61756e636863746c206c6f6164207e2f4c6962726172792f4c61756e63684167656e74732f6d61632e446f636b7365742e64656d616e2e706c697374 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_Imuler
{
strings:
	$a0 = { 2f55736572732f6170706c652f446f63756d656e74732f46696c654167656e742f }

condition:
	$a0
}

	
rule OSX_Trojan_Crisis_1
{
strings:
	$a0 = { 2f55736572732f677569646f2f50726f6a656374732f6472697665722d6d61636f732f6d63686f6f6b2e63 }

condition:
	$a0
}

	
rule OSX_RSPlug_2
{
strings:
	$a0 = { 24726573203d7e2074727c60202d5f7c61612d7a612d7a302d392b2f7c3b }
	$a1 = { 6d792024756e697169[0-16]226d61633b222e24636d6429 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_FkCodec_B
{
strings:
	$a0 = { 687474703a2f2f7777772e7768697465736d6f6b652e636f6d[174]5768697465536d6f6b6541707044656c6567617465 }

condition:
	$a0
}

	
rule Trojan_OSX_RSPlug_D
{
strings:
	$a0 = { 783d6063617420[0-4]207c7763202d6c7c61776b20277b7072696e742024317d27603b783d6065787072202478202d2032603b7461696c202d247820[0-4]207c7472207664656872756a7a70627161667774676b7879696c636e6f73207570786d6671727a696264616e77676b6574686c63796f7376 }

condition:
	$a0
}

	
rule Trojan_OSX_FkCodec_A
{
strings:
	$a0 = { 466c6f6174696e6720706f696e7420657863657074696f6e2072616973656420696e2074657374206461656d6f6e21[36]4461656d6f6e206f6273657276657220736f6d6520616374696f6e }
	$a1 = { 436f6465632d4d496e7374616c6c65722e6170702f436f6e74656e74732f4d61634f532f496e7374616c6c6572 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_OpinionSpy_A
{
strings:
	$a0 = { 4e6574436865636b[0-200]61736b55736572734669726577616c6c417070466f724f6e6c696e65436f6e74656e745065726d697373696f6e[0-20]4d6163[0-100]37617274[0-50]5f73637265656e73617665722e617070 }

condition:
	$a0
}

	
rule Trojan_OSX_OpinionSpy_B
{
strings:
	$a0 = { 53797374656d54726179436f6e74726f6c6c65723a2073686f7757686f417265596f75506f70[0-150]496e6a656374436f64652e6170702f436f6e74656e74732f4d61634f532f496e6a656374436f6465[0-10]496e6a656374436f64652e6170702f436f6e74656e74732f5265736f75726365732f6d61636d65746572686b2e62756e646c65 }

condition:
	$a0
}

	
rule Trojan_OSX_iServices_D
{
strings:
	$a0 = { 2f7573722f62696e2f69576f726b5365727669636573 }
	$a1 = { 7177666f6a7a6c6b2e66726565686f737469612e636f6d }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_RSPlug_L
{
strings:
	$a0 = { 41646f6265466c617368 }
	$a1 = { 7365642027732f6170706c656d61632f41646f6265466c6173682f27207c207365642027732f6273642f373030302f27207c207365642027732f676e752f27247479706527 }

condition:
	$a0 and $a1
}

	
rule OSX_Trojan_Crisis_2
{
strings:
	$a0 = { 636f6d2e6170706c652e736166617269[0-100]6f72672e6d6f7a696c6c612e66697265666f78[0-100]636f6d2e736b7970652e736b797065[0-100]636f6d2e6d6963726f736f66742e6d657373656e676572[0-100]636f6d2e616469756d582e616469756d58[0-100]73656d2d6d64776f726b6572 }

condition:
	$a0
}

	
rule Trojan_OSX_RSPlug_I
{
strings:
	$a0 = { 4d603239445d56384531363d5521223f403c522b4f58522b534d23314f5c522e4f242337525045294f4422374e51452a4e4022374950452b4850552b4d[0-5]5931572b533d22284435563c40502728475c22395329562b573c532d575c523c47602239452d27285c21223d555d2639542d572b563526394f60523b4d }

condition:
	$a0
}

	
rule Trojan_OSX_RSPlug_K
{
strings:
	$a0 = { 2a54542e573024304938322c215543294454252f373543305c3c352c324942285124542e27555235593c232a2c49432d3931342e57602432493832294d[0-5]2e5153355d34242f22214530573c322a5c4c3331312945222d45432c6051352a4754523358383533255553283845442f3221263158383336335543354d[0-5]5528552a23312531572c35333d2942314d50542e375532314a28322c334d43354d4c342e576033324e6025324a4830335c38222d3b5552345c3c352b4d }

condition:
	$a0
}

	
rule Trojan_OSX_iServices_C
{
strings:
	$a0 = { 2f7573722f62696e2f44697658 }
	$a1 = { 7177666f6a7a6c6b2e66726565686f737469612e636f6d }

condition:
	$a0 and $a1
}

	
rule OSX_Flashback_19
{
strings:
	$a0 = { 5061796c6f61642e6a617661 }
	$a1 = { 2f746d702f2e737973656e746572 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_Inqtana_A
{
strings:
	$a0 = { 44594c445f494e534552545f4c49425241524945533c2f6b65793e[10]737472696e673e2f70776e65642e64796c69623c2f737472696e67 }

condition:
	$a0
}

	
rule OSX_Trojan_Crisis
{
strings:
	$a0 = { 2f746d702f343374393930337a7a252e38642e58585858 }

condition:
	$a0
}

	
rule Trojan_OSX_FkCodec_C
{
strings:
	$a0 = { 7570646174652e636f6465636d2e636f6d[233]72657475726e2076616c756520746f20696e6a656374656420736372697074 }

condition:
	$a0
}

	
rule OSX_Flashback_10
{
strings:
	$a0 = { 007c3000557365722d4167656e740000256400200a0d09000000000047455400676f6f676c652e00200026003d002532 }

condition:
	$a0
}

	
rule Trojan_OSX_Darkoperator_A
{
strings:
	$a0 = { 2f7573722f62696e2f6d616332[137]746f6464686172726973205265616c4e616d6520224461726b6f70657261746f72[118]6461726b205040353577307264 }

condition:
	$a0
}

	
rule OSX_Flashback_12
{
strings:
	$a0 = { 3c7363726970743e77696e646f772e676f6f676c654a61766153637269707452656469726563743d313c2f7363726970743e3c7363726970743e76617220613d706172656e742c623d706172656e742e676f6f676c652c633d6c6f636174696f6e3b69662861213d77696e646f77262662297b696628622e72297b622e723d303b612e6c6f636174696f6e2e687265663d22 }

condition:
	$a0
}

	
rule OSX_Flashback_13
{
strings:
	$a0 = { 2f55736572732f73746576652f4c6962726172792f507265666572656e6365732f507265666572656e6365732e64796c6962 }

condition:
	$a0
}

	
rule OSX_Flashback_14
{
strings:
	$a0 = { 2020006b6565702d616c697665004b6565702d416c697665004b6565702d616c697665007b444f4d41494e7d007c4e007b425352517d00747275650066616c73 }

condition:
	$a0
}

	
rule OSX_Maljava
{
strings:
	$a0 = { 6e6f68757020707974686f6e202f55736572732f5368617265642f7570646174652e7079202d63206d61632e7570646174652e7a796e732e636f6d202d542061646170746174697665 }

condition:
	$a0
}

	
rule OSX_Trojan_Musminim
{
strings:
	$a0 = { cefaedfe }
	$a1 = { 61636b65642e7a697000000000064f776e656421000000001257696e646f77312e544350536f636b65743100000000065f496e64657800000000095f53657449 }

condition:
	$a0 and $a1
}

	
rule VirTool_OSX_Rubilyn_A
{
strings:
	$a0 = { 49206e65766572207365656d20746f206861766520616e797468696e6720746861742069662049206c6f7374206974[20-30]727562696c796e }
	$a1 = { 636f6d2e6861636b657266616e7461737469632e727562696c796e }

condition:
	$a0 and $a1
}

	
rule OSX_DNSChanger
{
strings:
	$a0 = { 496e7465726e657420506c75672d496e73220a0a505349443d242820282f7573722f7362696e2f73637574696c207c2067726570 }
	$a1 = { 6063726f6e746162202d6c7c6772657020706c7567696e732e73657474696e6773600a0a6966205b202224657869737422203d3d202222205d3b207468656e0a096563686f20222a202a202a202a202a20 }

condition:
	$a0 and $a1
}

	
rule Trojan_OSX_Netweird_A
{
strings:
	$a0 = { 4f706572612f77616e642e646174[114]6c69626d6f7a73716c697465332e64796c6962 }
	$a1 = { 73656c656374202a202066726f6d206d6f7a5f6c6f67696e73 }
	$a2 = { 252e32642f252e32642f256420252e32643a252e32643a252e3264 }

condition:
	$a0 and $a1 and $a2
}

	
rule OSX_Word_Malware
{
strings:
	$a0 = { 2f446576656c6f7065722f6c6f6e676765676550726f6a6563742f4d616320436f6e74726f6c2f4d6163436f6e74726f6c }

condition:
	$a0
}

	
rule Trojan_OSX_iMunizator_A
{
strings:
	$a0 = { 636f6d2e694d756e697a61746f722e694d756e697a61746f724461656d6f6e }
	$a1 = { 6b696c6c616c6c2046696e646572 }
	$a2 = { 436c69636b20746865206c6f636b20746f2061757468656e7469666963617465 }
	$a3 = { 46696e6973686564207363616e6e696e6720756e6e65636573736172792070726566666572656e636573 }

condition:
	$a0 and $a1 and $a2 and $a3
}

	